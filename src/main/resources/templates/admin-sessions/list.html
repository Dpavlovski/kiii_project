<!DOCTYPE html >
<html lang="en"
      xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{layout}" xmlns:sec="http://www.w3.org/1999/xhtml">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <link href="/bootstrap.css" rel="stylesheet">
    <style>
        .zoom-on-hover:hover {
            transform: scale(1.1);
            transition: transform 0.3s ease;
            filter: brightness(1.2);
            cursor: pointer;
        }

        tbody tr {
            transition: box-shadow 0.3s;
        }

        tbody tr:hover {
            box-shadow: 0px 4px 8px rgba(0, 0, 0, 0.2);
        }

    </style>
    <script>
        $(document).ready(function () {
            $(".delete-it").click(function () {
                var form = $(this).closest("form");
                bootbox.confirm({
                    message: "Are you sure you want to delete this session?",
                    buttons: {
                        confirm: {
                            label: 'Yes',
                            className: 'btn-danger'
                        },
                        cancel: {
                            label: 'No',
                            className: 'btn-secondary'
                        }
                    },
                    callback: function (result) {
                        if (result) {
                            // If the user clicks "Yes," submit the form
                            form.submit();
                        }
                    }
                });
            });
        });
    </script>
</head>
<body>


<div class="" layout:fragment="content">
    <section class="p-3" style="border-radius: 10px; background-color: 	#F0F0F0">
        <form th:method="GET">
            <div class="d-flex justify-content-around row">
                <div class="col-2">
                    <label for="timeFrom" class="form-label text-secondary font-weight-bold">Датум од:</label>
                    <input type="datetime-local" id="timeFrom" name="timeFrom" class="form-control"
                           th:value="${param.timeFrom}">
                </div>
                <div class="col-2">
                    <label for="timeTo" class="form-label text-secondary font-weight-bold">Датум до:</label>
                    <input type="datetime-local" id="timeTo" name="timeTo" class="form-control"
                           th:value="${param.timeTo}">
                </div>
                <div class="col-2">
                    <label for="requestType" class="form-label text-secondary font-weight-bold">Тип на молба:</label>
                    <select id="requestType" name="requestType" class="form-control">
                        <option value="">сите молби</option>
                        <option th:each="requestType : ${requestTypes}" th:value="${requestType}"
                                th:selected="${param.requestType != null && requestType.name() == param.requestType[0]}"
                                th:text="${requestType.name}"></option>
                    </select>
                </div>

                <div class="col-2">
                    <label for="semester" class="form-label text-secondary font-weight-bold">Семестар:</label>
                    <select id="semester" name="semester" class="form-control">
                        <option value="">сите семестри</option>
                        <option th:each="semester : ${semesters}" th:value="${semester.code}"
                                th:selected="${param.semester != null && semester.code == param.semester[0]}"
                                th:text="${semester.code}"></option>
                    </select>
                </div>

                <div class="col-2">
                    <label for="active" class="form-label text-secondary font-weight-bold">Покажи активни:</label>
                    <div class="form-check form-switch">
                        <input type="checkbox" id="active" name="active" class="form-check-input"
                               th:checked="${param.active}">
                        <label class="form-check-label text-secondary" for="active">Активни</label>
                    </div>
                </div>
            </div>


            <div class="row d-flex mt-3 justify-content-center">
                <div class="d-flex justify-content-center mr-5">
                    <div class="mr-3">
                        <button th:action="@{'/admin'}" type="submit" class="btn btn-primary">Пребарај</button>
                    </div>
                    <div class="mr-3">
                        <a th:href="@{'/admin'}" class="btn   btn-secondary" style="white-space: nowrap;">Отстрани
                            филтри</a>
                    </div>
                </div>

                <div class="mr-3"
                     sec:authorize="hasAnyRole('FINANCES_VICE_DEAN', 'ACADEMIC_AFFAIR_VICE_DEAN', 'STUDENT_ADMINISTRATION')">
                    <a th:href="@{'/admin/add'}" class="btn btn-success">Креирај нова сесија</a>
                </div>


            </div>
        </form>

    </section>


    <div class="row mt-4">
        <div class="col-12">
            <div class="table-responsive">
                <table class="table table-striped">
                    <thead class="text-white" style="background-color: #2A93D1">
                    <tr>
                        <th scope="col">Семестар</th>
                        <th scope="col">Време од</th>
                        <th scope="col">Време до</th>
                        <th scope="col">Опис</th>
                        <th scope="col">Забелешка за прифаќање</th>
                        <th scope="col">Тип на молба</th>
                        <th scope="col">Акции</th>
                    </tr>
                    </thead>
                    <tbody>
                    <tr th:each="requestSession : ${sessionPage.content}" class="product">
                        <td th:text="${requestSession.semester.code}"></td>
                        <td th:text="${requestSession.timeFrom}"></td>
                        <td th:text="${requestSession.timeTo}"></td>
                        <td style="white-space: nowrap; overflow: hidden; text-overflow: ellipsis; max-width:100px;"
                            th:text="${requestSession.description}"></td>
                        <td th:text="${requestSession.approvalNote}"></td>
                        <td th:text="${requestSession.requestType}"></td>
                        <td class="text-right">
                            <div class="button-container d-flex justify-content-around">
                                <div
                                        style="display: inline-block; margin-right: 10px;">
                                    <form id="deleteForm" th:action="@{'/admin/delete/{id}' (id=${requestSession.id})}"
                                          th:method="POST">
                                        <img src="/delete.png" style="width:20px; height:20px; opacity: 0.7;"
                                             alt="Delete" class="zoom-on-hover delete-it">
                                    </form>
                                </div>

                                <div
                                        style="display: inline-block; margin-right: 10px;">
                                    <a th:href="@{'/admin/edit/{id}' (id=${requestSession.id})}" class="mt-1">
                                        <img src="/edit.png" style="width:20px; height:20px" alt="Edit"
                                             class="zoom-on-hover">
                                    </a>
                                </div>

                                <div style="display: inline-block;">
                                    <a th:href="@{'/admin/{requestType}/{id}'(requestType=${requestSession.requestType}, id=${requestSession.id})}"
                                       class="mt-1">
                                        <img src="/list-text.png" style="width:20px; height:20px" alt="Show"
                                             class="zoom-on-hover">
                                    </a>
                                </div>
                            </div>
                        </td>

                    </tr>
                    </tbody>
                </table>
            </div>
        </div>
    </div>
    <div th:include="fragments/paging :: pageSection(${sessionPage})"></div>
</div>


</body>
</html>